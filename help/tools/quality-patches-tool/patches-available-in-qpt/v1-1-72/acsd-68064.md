---
title: 'ACSD-68064: voci duplicate create durante gli aggiornamenti pianificati in ambienti con categorie profondamente nidificate'
description: Applica la patch ACSD-68064 per risolvere il problema di Adobe Commerce, se la creazione di aggiornamenti pianificati in ambienti con un numero elevato di categorie nidificate genera voci duplicate e impedisce il salvataggio delle categorie.
feature: Catalog Management
role: Admin, Developer
type: Troubleshooting
source-git-commit: c7a955e6f9131255420ad0a163e457bd27cfc253
workflow-type: tm+mt
source-wordcount: '393'
ht-degree: 0%

---


# ACSD-68064: voci duplicate create durante gli aggiornamenti pianificati in ambienti con categorie profondamente nidificate

La patch ACSD-68064 risolve il problema relativo alla creazione di aggiornamenti pianificati in ambienti con un numero elevato di categorie nidificate, che si traduce in voci duplicate e impedisce il salvataggio delle categorie. Questa patch è disponibile quando è installato [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.72. L’ID della patch è ACSD-68064. Questo problema è pianificato per la risoluzione in Adobe Commerce 2.4.9.

## Prodotti e versioni interessati

**La patch è stata creata per la versione di Adobe Commerce:**

* Adobe Commerce (tutti i metodi di implementazione) 2.4.7-p6

**Compatibile con le versioni di Adobe Commerce:**

* Adobe Commerce (tutti i metodi di implementazione) 2.4.7 - 2.4.7-p7

>[!NOTE]
>
>La patch potrebbe diventare applicabile ad altre versioni con le nuove versioni di [!DNL Quality Patches Tool]. Per verificare se la patch è compatibile con la versione di Adobe Commerce in uso, aggiornare il pacchetto `magento/quality-patches` alla versione più recente e verificare la compatibilità nella pagina [[!DNL Quality Patches Tool]: Cerca patch](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html). Utilizza l’ID patch come parola chiave di ricerca per individuare la patch.

## Problema

La creazione di aggiornamenti pianificati in ambienti con un numero elevato di categorie nidificate genera voci duplicate, causando errori e il mancato salvataggio della categoria.

<u>Passaggi da riprodurre</u>:

1. Installa un’istanza pulita.
1. Modificare il file degli staffaggi delle prestazioni (small.xml) in modo che includa:
   1. **[!UICONTROL Categories]**: *2500*
   1. **[!UICONTROL Products]**: *250.000*
1. Genera i dati utilizzando il comando:

   ```
   bin/magento setup:performance:generate-fixtures var/performance-toolkit/profiles/ce/small.xml
   ```

1. Dopo aver creato prodotti e categorie, assicurati che tutte le categorie siano impostate come ancoraggi eseguendo la seguente query:

   ```
   UPDATE catalog_category_entity_int set value = 1 where attribute_id = (select attribute_id from eav_attribute where attribute_code = 'is_anchor'); 
   ```

1. Reindicizzare i dati.
1. Accedere al pannello di amministrazione e passare a **[!UICONTROL Catalog]** > **[!UICONTROL Categories]**.
1. Sposta **Categoria 2** in **Categoria 1** per creare una struttura nidificata.
1. Passare a una categoria annidata in modo profondo, ad esempio **Categoria 2.1.1**.
1. Crea un **[!UICONTROL Scheduled Update]**.
1. Fare clic su **[!UICONTROL Save]**.

<u>Risultati previsti</u>:

La categoria è stata salvata correttamente.

<u>Risultati effettivi</u>:

Si verifica un errore e la categoria non viene salvata. `var/log/exception.log` contiene un errore simile a:

```
Exception #0 (Magento\Framework\DB\Adapter\DuplicateException): SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '229-255' for key 'temp_category_descendants_619aaaaaaaaaa.PRIMARY', query was: INSERT INTO `temp_category_descendants_619aaaaaaaaaa` (`category_id`, `descendant_id`) SELECT `ce`.`entity_id` AS `category_id`, `ce2`.`entity_id` AS `descendant_id` FROM `catalog_category_entity` AS `ce`
 INNER JOIN `catalog_category_entity` AS `ce2` ON ce2.path LIKE CONCAT(ce.path, '/%') OR ce2.entity_id = ce.entity_id AND (ce2.created_in <= '1750287600' AND ce2.updated_in > '1750287600') WHERE ((ce.entity_id IN (4, 6, 7, 8, 10, 24, 25, 27, 30, 33, 34, 35, 36, 37, 40, 41, 42, 43, 44, 48, 51, 54, 56, 57, 59, 60, 63, 64, 65, 66, 67 .......
```

## Applicare la patch

Per applicare singole patch, utilizzare i collegamenti seguenti, a seconda del metodo di distribuzione utilizzato:

* Adobe Commerce o Magento Open Source on-premise: [[!DNL Quality Patches Tool] > Utilizzo](/help/tools/quality-patches-tool/usage.md) nella guida di [!DNL Quality Patches Tool].
* Adobe Commerce su infrastruttura cloud: [Aggiornamenti e patch > Applica patch](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html) nella guida Commerce su infrastruttura cloud.

## Lettura correlata

Per ulteriori informazioni su [!DNL Quality Patches Tool], vedere:

* [[!DNL Quality Patches Tool]: strumento self-service per patch di qualità](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) nella guida degli strumenti.
