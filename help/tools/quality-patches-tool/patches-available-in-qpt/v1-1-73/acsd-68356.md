---
title: 'ACSD-68356: [!DNL GraphQL] la query del carrello restituisce un importo di sconto errato per le offerte virtuali'
description: Applica la patch ACSD-68356 per risolvere il problema di Adobe Commerce per cui la query del carrello  [!DNL GraphQL]  restituisce un importo di sconto errato per i preventivi virtuali.
feature: Shopping Cart, GraphQL
role: Admin, Developer
type: Troubleshooting
source-git-commit: de86326804ad0d27b3580d9cede964a59bfa77fe
workflow-type: tm+mt
source-wordcount: '338'
ht-degree: 0%

---

# ACSD-68356: la query del carrello [!DNL GraphQL] restituisce un importo di sconto errato per i preventivi virtuali

La patch ACSD-68356 risolve il problema per cui la query del carrello [!DNL GraphQL] restituisce un importo di sconto errato per i preventivi virtuali. Questa patch è disponibile quando è installato [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.73. L’ID della patch è ACSD-68356. Questo problema è pianificato per la risoluzione in Adobe Commerce 2.4.9.

## Prodotti e versioni interessati

**La patch è stata creata per la versione di Adobe Commerce:**

* Adobe Commerce (tutti i metodi di implementazione) 2.4.8-p2

**Compatibile con le versioni di Adobe Commerce:**

* Adobe Commerce (tutti i metodi di implementazione) 2.4.8 - 2.4.8-p3

>[!NOTE]
>
>La patch potrebbe diventare applicabile ad altre versioni con le nuove versioni di [!DNL Quality Patches Tool]. Per verificare se la patch è compatibile con la versione di Adobe Commerce in uso, aggiornare il pacchetto `magento/quality-patches` alla versione più recente e verificare la compatibilità nella pagina [[!DNL Quality Patches Tool]: Cerca patch](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html?lang=it). Utilizza l’ID patch come parola chiave di ricerca per individuare la patch.

## Problema

Le query del carrello [!DNL GraphQL] restituiscono importi di sconto non corretti per i preventivi virtuali, applicando sconti ai prodotti virtuali non idonei.

<u>Passaggi da riprodurre</u>:

1. Creare due prodotti virtuali:
   1. `virtual1` SKU
   1. `virtual2` SKU
1. Crea una regola prezzo carrello:
   1. Impostato per l&#39;applicazione automatica, senza coupon.
   1. Azioni:
   1. Percentuale di sconto sul prezzo del prodotto - 20%.
   1. Si applica solo agli elementi del carrello in cui lo SKU è `virtual2`.
1. Aggiungi prodotti a un nuovo preventivo vuoto tramite vetrina:
   1. Aggiungere prima `virtual1` SKU.
   1. Aggiungi `virtual2` SKU al secondo.
1. Ottenere i dettagli del carrello utilizzando la seguente query [!DNL GraphQL]:

   ```
   {
     cart(cart_id: "cart_id") {
       email
       itemsV2 {
         total_count
         items {
           uid
           prices {
             total_item_discount {
               value
             }
             price {
               value
             }
             discounts {
               label
               amount {
                 value
               }
             }
           }
           product {
             name
             sku
           }
           quantity
         },
         page_info {
             page_size
             current_page
             total_pages
         }
       }
       applied_coupons {
         code
       }
       prices {
         discounts {
           amount {
             value
           }
           applied_to
           label
         }
         grand_total {
           value
         }
       }
     }
   }
   ```

1. Selezionare **[!UICONTROL cart]** > **[!UICONTROL items]** > **[!UICONTROL prices]** > **[!UICONTROL discounts]**.

<u>Risultati previsti</u>:

* Lo SKU di `virtual1` non ha uno sconto elencato in [!DNL GraphQL]
* `virtual2` SKU con sconto elencato in [!DNL GraphQL]

<u>Risultati effettivi</u>:

* `virtual1` e `virtual2` mostrano erroneamente lo stesso importo di sconto nella risposta di [!DNL GraphQL].

## Applicare la patch

Per applicare singole patch, utilizzare i collegamenti seguenti, a seconda del metodo di distribuzione utilizzato:

* Adobe Commerce o Magento Open Source on-premise: [[!DNL Quality Patches Tool] > Utilizzo](/help/tools/quality-patches-tool/usage.md) nella guida di [!DNL Quality Patches Tool].
* Adobe Commerce su infrastruttura cloud: [Aggiornamenti e patch > Applica patch](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html?lang=it) nella guida Commerce su infrastruttura cloud.

## Lettura correlata

Per ulteriori informazioni su [!DNL Quality Patches Tool], vedere:

* [[!DNL Quality Patches Tool]: strumento self-service per patch di qualità](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) nella guida degli strumenti.
